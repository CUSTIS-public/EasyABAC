resources:
  subject:
    attributes:
    - id: id
    - id: allowed-categories
      title: categories available to the subject
      multiple: true
    - id: role
      allowableValues:
      - USER
      - ADMIN
  report:
    title: Report
    actions:
    - edit
    - view
    - remove
    attributes:
    - id: id
      type: int
      title: report code
    - id: category
      title: report access category
      allowableValues:
      - iod
      - dsp
permissions:
- title: report editing policy by category
  accessToActions:
    [report.edit]
  rules:
  - title: check whether the report can be accessed depending on the category
    operation: AND
    conditions:
    - report.category in subject.allowed-categories
    - subject.role in ['ADMIN', 'USER']
  returnAttributes:
    [subject.allowed-categories]
- title: policy of deleting a report depending on the category
  accessToActions:
    [report.remove]
  rules:
  - title: check whether the report can be accessed depending on the category
    operation: AND
    conditions:
    - report.category in subject.allowed-categories
  returnAttributes:
    [subject.allowed-categories]
- title: viewing policy depending on the role of the subject
  accessToActions:
    [report.view]
  rules:
  - title: check whether the report can be accessed depending on the category
    conditions:
    - subject.role == 'USER'

