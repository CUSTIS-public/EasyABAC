resources:
  subject:
    attributes:
    - id: id
    - id: allowed-categories
      title: categories available to the subject
      multiple: true
  report:
    title: Report
    actions:
    - edit
    - view
    - remove
    attributes:
    - id: id
      type: int
      title: report code
    - id: category
      title: report access category
      allowableValues:  # Valid values for policy validation
      - iod
      - dsp
permissions:
- title: policy delete report depending on category
  accessToActions:
    [report.remove]
  rules:
  - title: check whether the report can be accessed depending on the category
    operation: OR #it's just here to check the download. Possible operations: AND, OR, NAND, NOR
    conditions:
    - report.category in subject.allowed-categories
  returnAttributes:
    [subject.allowed-categories]
- title: report editing policy by category
  accessToActions:
    [report.edit, report.view]
  rules:
  - title: check whether the report can be accessed depending on the category
    operation: AND #it's just here to check the download. Possible operations: AND, OR, NAND, NOR
    conditions:
    - report.category in subject.allowed-categories
    - report.category in subject.allowed-categories
  returnAttributes:
    [subject.allowed-categories]
- title: report editing policy by category
  accessToActions:
     [report.edit, report.view]
  rules:
   - title: check whether the report can be accessed depending on the category
     operation: AND #it's just here to check the download. Possible operations: AND, OR, NAND, NOR
     conditions:
     - report.category in subject.allowed-categories
     - report.category in subject.allowed-categories
  returnAttributes:
     [subject.allowed-categories]